{{define "edit-content"}}
    <article class="page">
        <h2>{{if .Page}}Edit{{else}}Create{{end}}: {{.Title}}</h2>
        
        <form method="POST" action="/{{.Path}}?action=save" class="edit-form">
            <div class="form-group">
                <div id="pm-editor" class="edit-prosemirror"></div>
                <textarea name="content" id="editor-source" hidden>{{if .Page}}{{.Page.Content}}{{end}}</textarea>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="save-button">Save</button>
                <a href="/{{.Path}}" class="cancel-button">Cancel</a>
            </div>
        </form>
    </article>

    <script src="/static/editor/prosemirror.bundle.js"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function () {
        if (window.initProseMirrorEditor) {
            window.initProseMirrorEditor(
                document.getElementById("pm-editor"),
                document.getElementById("editor-source")
            );
        }

        const form = document.querySelector(".edit-form");
        form.addEventListener("submit", function () {
            if (window.getMarkdown) {
                document.getElementById("editor-source").value = window.getMarkdown();
            }
        });
    });
    </script>
{{end}}
