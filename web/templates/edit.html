{{define "edit-content"}}
    <article class="page">
        <h2>{{if .Page}}Edit{{else}}Create{{end}}: {{.Title}}</h2>
        
        <form method="POST" action="/{{.Path}}?action=save" class="edit-form">
            <div class="form-group">
                <textarea name="content" id="editor" class="edit-textarea" required>{{if .Page}}{{.Page.Content}}{{end}}</textarea>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="save-button">Save</button>
                <a href="/{{.Path}}" class="cancel-button">Cancel</a>
            </div>
        </form>
    </article>

    <!-- SimpleMDE JavaScript -->
    <link rel="stylesheet" href="/static/css/codemirror.min.css">
    <link rel="stylesheet" href="/static/css/simplemde.min.css">
    <script src="/static/js/codemirror.min.js"></script>
    <script src="/static/js/simplemde.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if SimpleMDE is loaded (not just our placeholder)
            if (typeof SimpleMDE !== 'undefined') {
                var editor = new SimpleMDE({
                    element: document.getElementById("editor"),
                    spellChecker: false,
                    autofocus: true,
                    placeholder: "Type your markdown content here...",
                    renderingConfig: {
                        singleLineBreaks: false,
                        codeSyntaxHighlighting: true
                    },
                    toolbar: [
                        "bold", "italic", "heading", "|",
                        "quote", "code", "table", "|",
                        "unordered-list", "ordered-list", "|",
                        "link", "image", "|",
                        "preview", "side-by-side", "fullscreen", "|",
                        "guide"
                    ]
                });
            } else {
                console.log("SimpleMDE not loaded. Using basic textarea.");
                // Fallback: just make the textarea larger
                document.getElementById("editor").style.height = "300px";
            }
        });
    </script>
{{end}}
